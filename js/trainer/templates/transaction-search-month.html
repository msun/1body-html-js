<ion-view view-title="My Sessions" cache-view="false">
    <ion-nav-buttons side="right">
        <a ng-href="#/menu/calendar/my-schedule/{{$root.user.$id}}/{{$root.user.username}}" class="button button-icon icon ion-calendar">Calendar</a>
    </ion-nav-buttons>

    <ion-content class="has-header ob-grey-bg">

        <div class="list">
            <!--<div class="ob-list">-->
            <!--<div class="ob-form-row ob-form-flex-row" ng-click="openDatePicker()">-->
            <time-picker class="ob-form-timepicker"
                         show-time-picker="false"
                         show-date-picker="false"
                         data-inc-icon-class="ion ion-chevron-up"
                         data-dec-icon-class="ion ion-chevron-down"></time-picker>

            OrderBy:
            <select ng-model="predicate">
                <option value="user">User</option>
                <option value="starttime">Start Time</option>
                <option value="created">Creation Time</option>
            </select>


            <p class="ob-list-text">Total Earnings From {{params.yearMonth}}: {{total | number:2}}</p>

            <div ng-show="transactions.length <= 0" class="ob-list-emptytext">No sessions to display</div>

            <div class="item" id="chart1" ac-chart="chartType" ac-data="data1" ac-config="config1"></div>

            <div class="ob-list" ng-show="predicate == 'user'">
                <div ng-repeat="tran in userTransactions | orderBy: '-total'">

                    <div class="ob-list-col-img">
                        <img class="ob-list-img"
                             src="https://s3.amazonaws.com/com.onebody.profile/Users/{{tran.userID | htmlEncode}}/profilepic.jpg"
                             onerror="this.src='img/emptypic-user.png'"/>
                    </div>
                    <div class="ob-list-col-flex">
                        <div class="ob-list-text">User: {{tran.userName}}</div>
                        <div class="ob-list-subtext">Start Time: {{tran.starttime | date:'yyyy-MM-dd HH:mm:ss'}}</div>
                    </div>
                    <p class="ob-list-emptytext">Total Earnings {{tran.yearMonth}}: ${{tran.total |  number:2}}</p>
                    <div class="ob-list">
                        <a class="ob-list-text" ng-repeat="item in tran.transactions | orderBy: '-starttime'" ng-href="#/menu/transaction-detail/{{item.$id}}">
                            <div class="ob-list-subtext">Start Time: {{item.starttime | date:'yyyy-MM-dd HH:mm:ss'}}</div>
                            <div class="ob-list-subtext">Created: {{item.created | date:'yyyy-MM-dd HH:mm:ss'}}</div>
                            <div class="ob-list-subtext">Tokens: {{item.tokens}}</div>
                            <div class="ob-list-subtext">Review: {{item.text}}</div>
                            <div class="profile-feed-review-stars">
                                <span class="profile-feed-review-star" ng-show="item.review.rating > 0" id="profile-feed-review-star-1"></span>
                                <span class="profile-feed-review-star" ng-show="item.review.rating > 1" id="profile-feed-review-star-2"></span>
                                <span class="profile-feed-review-star" ng-show="item.review.rating > 2" id="profile-feed-review-star-3"></span>
                                <span class="profile-feed-review-star" ng-show="item.review.rating > 3" id="profile-feed-review-star-4"></span>
                                <span class="profile-feed-review-star" ng-show="item.review.rating > 4" id="profile-feed-review-star-5"></span>
                            </div>
                            <div class="ob-list-subtext">Duration: {{item.duration * 30}} mins</div>
                        </a>
                    </div>
                </div>
            </div>

            <div class="ob-list" ng-show="predicate == 'starttime' || predicate == 'created'">
                <a class="ob-list-row" ng-repeat="item in transactions | orderBy:predicate" item="event" ng-href="#/menu/transaction-detail/{{item.$id}}">
                    <div class="ob-list-col-img">
                        <img class="ob-list-img"
                             src="https://s3.amazonaws.com/com.onebody.profile/Users/{{item.userID | htmlEncode}}/profilepic.jpg"
                             onerror="this.src='img/emptypic-user.png'"/>
                    </div>
                    <div class="ob-list-col-flex">
                        <div class="ob-list-text">User: {{item.userName}}</div>
                        <div class="ob-list-subtext">Start Time: {{item.starttime | date:'yyyy-MM-dd HH:mm:ss'}}</div>
                        <div class="ob-list-subtext">Created Time: {{item.created | date:'yyyy-MM-dd HH:mm:ss'}}</div>
                        <!--<div class="ob-list-subtext">Created: {{item.created | date:'yyyy-MM-dd HH:mm:ss'}}</div>-->
                        <div class="ob-list-subtext">Duration: {{item.duration * 30}} mins</div>
                    </div>
                </a>
            </div>
        </div>

        <style type="text/css">
            [ac-chart] {
                width: 100%;
                height: 400px;
                margin: 0 1%;
            }

            .ac-tooltip {
                color: black;
                border: 2px solid rgba(200,200,0,0.8);
                background-color: rgba(200,200,0,0.5);
                z-index: 999;
            }

            #chart1 .ac-legend-box {
                border-radius: 10px;
            }

        </style>

    </ion-content>
</ion-view>
